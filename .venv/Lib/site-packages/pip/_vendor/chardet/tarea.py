import tkinter as tk
from tkinter import messagebox

# Operadores en texto
operadores = {
    "mas": "+",
    "menos": "-",
    "por": "*",
    "entre": "/"
}


# Verifica número
def es_numero(palabra):
    try:
        float(palabra)
        return True
    except:
        return False


# Separa texto unido/num y op// o con espacios
def separar_palabras(texto):
    resultado, palabra, numero = [], '', ''
    i = 0
    while i < len(texto):
        c = texto[i]

        # Si el carácter es un dígito o un punto //deci
        if c.isdigit() or c == '.':
            if palabra:
                resultado.append(palabra)
                palabra = ''
            numero += c

        # Si el carácter es un espacio o un operador
        elif c in " +-*/":
            if numero:
                resultado.append(numero)
                numero = ''
            # Verificar si es un operador en texto
            if c != ' ':
                palabra += c
                for op in operadores:
                    if palabra.strip() == op:
                        resultado.append(operadores[op])
                        palabra = ''
                        break
            else:
                if palabra:
                    resultado.append(palabra)
                    palabra = ''
        else:
            # Si no es número ni espacio ni operador, agregar al acumulado
            palabra += c

        i += 1

    if palabra: resultado.append(palabra)
    if numero: resultado.append(numero)

    return resultado


#  palabras a símbolos
def traducir_expresion(palabras):
    resultado = []
    for palabra in palabras:
        if palabra in operadores:
            resultado.append(operadores[palabra])
        elif es_numero(palabra):
            resultado.append(palabra)
        else:
            messagebox.showerror("Error", f"No reconozco: {palabra}")
            return None
    return resultado


# evalúa la expresión
def evaluar_expresion(lista):
    i = 0
    while i < len(lista):
        if lista[i] in ("*", "/"):
            a, b = float(lista[i - 1]), float(lista[i + 1])
            r = a * b if lista[i] == "*" else a / b
            lista[i - 1:i + 2] = [str(r)]
            i = 0
        else:
            i += 1
    i = 0
    while i < len(lista):
        if lista[i] in ("+", "-"):
            a, b = float(lista[i - 1]), float(lista[i + 1])
            r = a + b if lista[i] == "+" else a - b
            lista[i - 1:i + 2] = [str(r)]
            i = 0
        else:
            i += 1
    return float(lista[0])


# Controlador de botón
def calcular():
    entrada = entrada_texto.get().lower().strip()
    palabras = separar_palabras(entrada)
    expr = traducir_expresion(palabras)
    if expr:
        try:
            resultado = evaluar_expresion(expr)
            resultado_label.config(text=f"Resultado: {resultado}")
        except:
            messagebox.showerror("Error", "No se pudo calcular.")


# Interfaz
ventana = tk.Tk()
ventana.title("Calculadora de Palabras")
ventana.geometry("400x320")
ventana.configure(bg="#f0f4f7")

tk.Label(ventana, text="Calculadora de Palabras", font=("Arial", 18), bg="#f0f4f7").pack(pady=15)
entrada_texto = tk.Entry(ventana, font=("Arial", 14), width=30, justify="center")
entrada_texto.pack(pady=10)

tk.Button(ventana, text="Calcular", font=("Arial", 14), command=calcular, borderwidth=2).pack(pady=10)

# label respuesta
resultado_label = tk.Label(ventana, text="Resultado: ", font=("Arial", 14), bg="#f0f4f7")
resultado_label.pack(pady=10)

ventana.mainloop()
